MyEXT60804=typeof MyEXT60804!=="undefined"?MyEXT60804:{};MyEXT60804.__files_present__=MyEXT60804.__files_present__?MyEXT60804.__files_present__+"k":"k";MyEXT60804.FolderIOWrapper=function(t){var v=MyEXT60804.Consts;var q=MyEXT60804.Console;var j=MyEXT60804.XHR;var h=MyEXT60804.Utils;var k=["extensions",v.CROSSRIDER_EXTENSION_UUID];var r=(t&&t.rootPath)?t.rootPath:["resources"];var a;var s=function(){};Components.utils["import"]("resource://gre/modules/FileUtils.jsm");Components.utils["import"]("resource://gre/modules/NetUtil.jsm");var p=Components.classes["@mozilla.org/intl/scriptableunicodeconverter"].createInstance(Components.interfaces.nsIScriptableUnicodeConverter);var l=function(y,x,z){var w=function(C,D){return function(F){var E=function(I,J){if(C&&(typeof C=="function")){C(I,J);}};var G=function(I,J){if(D&&(typeof D=="function")){D(I,J);}};var H=F.additionalInfo;if(F.call==="success"){E(F.response,H);}else{G(F.response,H);}};};try{x=(typeof x==="function")?x:s;z=(typeof z==="function")?z:s;var B=new MyEXT60804.XHR({url:y,method:"GET",async:true,callback:w(x,z)});B.send();}catch(A){callback({call:"failure",response:"Failed To Make _request: "+y});}};var g=function(z){var x=true;var y,w;z.onSuccess=z.onSuccess||s;try{w=k.concat(z.path);y=FileUtils.getDir("ProfD",w,x);z.onSuccess(y);}catch(A){}};var i=function(B){var A=384;var y,x,z,D;B.onSuccess=B.onSuccess||s;B.onError=B.onError||s;try{y=a.clone();for(var w=0;w<B.path.length;w++){y.append(B.path[w]);}if(!y.exists()){y.create(Components.interfaces.nsIFile.NORMAL_FILE_TYPE,A);}x=FileUtils.openSafeFileOutputStream(y);p.charset="UTF-8";D=p.convertToInputStream(B.content);NetUtil.asyncCopy(D,x,function(E){if(!Components.isSuccessCode(E)){B.onError(E);return;}B.onSuccess();});}catch(C){}};var f=function(x){var A="@mozilla.org/scriptableinputstream;1",E=Components.interfaces.nsIScriptableInputStream,w="@mozilla.org/network/file-input-stream;1",B=Components.interfaces.nsIFileInputStream;try{var z="";var D=Components.classes[w].createInstance(B);var y=Components.classes[A].createInstance(E);D.init(x,1,0,false);y.init(D);z+=y.read(-1);y.close();D.close();return z;}catch(C){return false;}};var c=function(w,y,x){NetUtil.asyncFetch(w,function(A,z){var C;if(!Components.isSuccessCode(z)){x();return;}try{A.available();}catch(B){x();return;}try{C=NetUtil.readInputStreamToString(A,A.available());}catch(B){x();return;}y(C);});};var m=function(x){x.onSuccess=x.onSuccess||s;x.onError=x.onError||s;try{file=a.clone();for(var w=0;w<x.path.length;w++){file.append(x.path[w]);}if(h.getFirefoxVersion()<4){x.onSuccess(f(file));return;}c(file,x.onSuccess,x.onError);}catch(y){x.onError();}};var d=function(w){w.onSuccess=w.onSuccess||s;w.onError=w.onError||s;l(w.url,function(x){i({path:w.path,content:x,onSuccess:w.onSuccess,onError:w.onError});},function(){w.onError();});};var b=function(x){var w;w=FileUtils.getFile("ProfD",r.concat([x.fileName]));return w.exists();};var o=function(z){try{var w=a.directoryEntries;var y=[];z.onSuccess=z.onSuccess||s;while(w.hasMoreElements()){var x=w.getNext();x.QueryInterface(Components.interfaces.nsIFile);y.push(x.leafName);}return y;}catch(A){return[];}};var n=function(w){return a.path;};var u=function(y){var w,x;try{x=FileUtils.getFile("ProfD",r.concat(y.path));if(!x.exists){w=false;}else{x.remove();w=true;}}catch(z){w=false;}return w;};(function e(){g({path:r,onSuccess:function(w){a=w;}});r=k.concat(r);}());return{create:i,readAll:m,createFromRemote:d,isExists:b,getFiles:o,getRealPath:n,remove:u};};
